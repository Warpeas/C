问题 A: Add polynomials together时间限制: 1 Sec  内存限制: 128 MB
提交: 946  解决: 152
[[提交](https://acm.sustech.edu.cn/onlinejudge/submitpage.php?cid=1055&pid=0&langmask=0)][[状态](https://acm.sustech.edu.cn/onlinejudge/problemstatus.php?id=1261)][[讨论版](https://acm.sustech.edu.cn/onlinejudge/bbs.php?pid=1261&cid=1055)]

## 题目描述

As Narnal has learned in the class, a polynomial can be represented as a linked list, but he failed to add two given polynomials together. He asks you to help him to get the summation of two polynomials.

## 输入

First line will be a positive integer TT, which is the number of test cases.

In each test case, the first line will be an integer nn for the number of terms of the first polynomial. Then the next nn lines will be the coefficients and exponents of the terms with the order of **increasing** exponents.

After n+1n+1 lines, there will be an integer mm for the number of terms of the second polynomial. Then the next mm lines will be the coefficients and exponents of the terms with the order of **increasing** exponents.

After n+m+2n+m+2 lines, there will be an integer qq denoting the number of queries. Then one line containing qq **ascending**numbers will follow, where each number kk represents a query for the coefficient of exponent of kk.

1≤T≤200,1≤n,m≤103,1≤q≤2×103,0≤k≤1091≤T≤200,1≤n,m≤103,1≤q≤2×103,0≤k≤109. The **coefficients** will be in range [−104,104][−104,104]. The **exponents** will be in range [0,109][0,109].

## 输出

For each case, output one line contains qq answers of the corresponding queries.

## 样例输入

```
1
2
1 1
2 3
3
1 100
3 150
5 170
4
1 20 100 170
```

## 样例输出

```
1 0 1 5
```

## 提示



问题 B: Black era时间限制: 1 Sec  内存限制: 128 MB
提交: 576  解决: 120
[[提交](https://acm.sustech.edu.cn/onlinejudge/submitpage.php?cid=1055&pid=1&langmask=0)][[状态](https://acm.sustech.edu.cn/onlinejudge/problemstatus.php?id=1262)][[讨论版](https://acm.sustech.edu.cn/onlinejudge/bbs.php?pid=1262&cid=1055)]

## 题目描述

The war in Ursus has broken out! Now, Wamiya and her teammates have to escape from this dangerous place immediately. In order to avoid the falling objects from the surrounding buildings, all the team members are lined up in a row while moving forward. In order to defend against enemy attacks, Wamiya should also constantly change the form of the team by exchanging two parts of the row, i.e., she will specify two continuous parts in the row, and exchange their locations without changing anything inside each part. There will be NN members in the team, and Wamiya will give MMorders one by one. Given the initial team, what will be the final team after their escape?

## 输入

First line contains one integer T, indicating that there will be T cases.

For each case, the first line will be two integers N and M. N is the number of the members in the team, and M is the number of orders.

The second line will be N integers, indicating the initial formation of the team. Each number is unique and represents the ID of the member. We guarantee that ID is in the range of \[0,N−1].

The following MM lines represent MM orders. In each line, there are four integers x1,y1,x2,y2x1,y1,x2,y2, which mean the part [x1,y1][x1,y1] (starting from member with ID x1x1 and ending at the member with ID y1y1), should exchange the position with part [x2,y2][x2,y2].

T≤5,1≤N,M≤105T≤5,1≤N,M≤105. We guarantee that in each order, members with ID x1,y1,x2,y2x1,y1,x2,y2 will be arranged in order from front to back in the row. Notice that x1x1 could be equal to y1y1 and x2x2 could be equal to y2y2.

## 输出

For each case, output NN integer in one line to represent the final team consisting of member IDs.

## 样例输入

```
1
10 2
0 6 5 1 2 3 4 8 7 9
6 4 7 9
0 8 6 5
```

## 样例输出

```
6 5 0 7 9 8 1 2 3 4
```

## 提示



问题 C: Coverted Vinux input时间限制: 1 Sec  内存限制: 128 MB
提交: 409  解决: 76
[[提交](https://acm.sustech.edu.cn/onlinejudge/submitpage.php?cid=1055&pid=2&langmask=0)][[状态](https://acm.sustech.edu.cn/onlinejudge/problemstatus.php?id=1263)][[讨论版](https://acm.sustech.edu.cn/onlinejudge/bbs.php?pid=1263&cid=1055)]

## 题目描述

Narnal is a huge fan of vim, so he has created a text editor called Vinux, which can only edit one line with several operations. Each line has an invisible undeletable tail character called EOL (end of line), which will always stay at the end of the line in any circumstance. **Notice that the undeletable property of EOL means that EOL will revive immediately at the end of the line whenever it vanishes (been replaced or deleted).** He wants to covert a **one-line** keyboard input containing operations and digits into a **one-line** real input with only digits.

Only the following operations are available:

r: next single input would replace the current character;

I: move the character pointer to the head of the line;

H: left shift the current character pointer unless it is at the leftmost place;

L: right shift the current character pointer unless it is at the rightmost place;

x: delete the current character;

Otherwise, each input would insert before the current character.

## 输入

First line will be a positive integer T, which is the number of test cases.

In each test case, the first line would be an integer n for the length of the keyboard input of Vinux. Then the following line represents the keyboard input of Vinux.

T≤20,20≤n≤105. The aiming real input only contains digits without blanks. The input would always be valid (the input after r would never be an operation character).

## 输出

For each case, output one line shows the real input without EOL.

## 样例输入

```
2
25
12345HHHr9Ir000LLLLL876Ix
20
r60xxxxHx4xHH3III1I2
```

## 样例输出

```
002945876
2134
```

## 提示



Sample 1

 real:

index:

input:





Sample 2

 real:

index:

input:



问题 D: Difficult Josephus problem时间限制: 3 Sec  内存限制: 256 MB
提交: 285  解决: 97
[[提交](https://acm.sustech.edu.cn/onlinejudge/submitpage.php?cid=1055&pid=3&langmask=0)][[状态](https://acm.sustech.edu.cn/onlinejudge/problemstatus.php?id=1264)][[讨论版](https://acm.sustech.edu.cn/onlinejudge/bbs.php?pid=1264&cid=1055)]

## 题目描述

[**Josephus problem**](https://en.wikipedia.org/wiki/Josephus_problem) is a theoretical problem related to a certain [counting-out game](https://en.wikipedia.org/wiki/Counting-out_game). However, Narnal thought this problem is too easy for him, so he constructed a more complex Josephus problem as following.

There are nn people standing in a circle indexing from 11 to nn, and each person in the circle holds a note marked with a positive integer. At first, given a positive integer mm, people count the number from one to the next starting from index 11 in clockwise (1,2,…,n,1,2,…1,2,…,n,1,2,…). When the counted number reaches mm, the corresponding person will be eliminated from the circle and yell the number in his/her note, denoted by kiki, and then people restart counting from the next person targeting for number kiki until, eventually, only one person is left in the circle.

## 输入

First line will be a positive integer TT, which is the number of test cases.

In each test case, the first line would be two integers nn and mm, where nn is the initial number of people, and mm is the initial target counting number.

Then there will be a single line containing nn integers, indicating the number on each person's note, from index 11 to index nn.

T≤100,1≤n≤104T≤100,1≤n≤104. mm and each number on the notes will be in the range of [1,108][1,108]. We guarantee that there are no more than 2020 cases with n>5×103n>5×103.

## 输出

For each case, output one line with one integer for the index of the remaining people.

## 样例输入

```
2
5 2
2 2 2 2 2
10 10
100000000 1 2 3 4 5 6 7 8 9
```

## 样例输出

```
3
1
```

## 提示



oblem!🎉🎉🎉



问题 E: Eccentric calculator时间限制: 3 Sec  内存限制: 20 MB
提交: 456  解决: 103
[[提交](https://acm.sustech.edu.cn/onlinejudge/submitpage.php?cid=1055&pid=4&langmask=0)][[状态](https://acm.sustech.edu.cn/onlinejudge/problemstatus.php?id=1265)][[讨论版](https://acm.sustech.edu.cn/onlinejudge/bbs.php?pid=1265&cid=1055)]

## 题目描述

Yuki is a clever girl and she is playing an eccentric calulator. The eccentric calculator can only display nn digits, which really annoys her.

She enters a number mm in the calculator first, and then just repeatedly squares it until the result overflows. When it overflows, only the nn most **significant** digits can still be displayed on the screen, and an error will appear at the same time. Yuki can clear the error flag and continue squaring the displayed number. She wonders what is the largest number she can get by repeatedly doing this procedure for given nn and mm.

## 输入

The first line contains an integer tt (1≤t≤2001≤t≤200) — the number of test cases. Each test case contains one line with two integers: nn and mm (1≤n≤9,0≤m<10n1≤n≤9,0≤m<10n) — the number of digits and the starting number.

## 输出

For each test case, print one line with the maximum number that Yuki can obtain.

## 样例输入

```
2
1 5
2 99
```

## 样例输出

```
5
99
```

## 提示



Yuki can obtain 5→2(5)→4→1(6)→1→1→⋯5→2(5)→4→1(6)→1→1→⋯ respectively in the first case by repeatedly squaring it.



问题 F: From-now-on minimum difference时间限制: 5 Sec  内存限制: 256 MB
提交: 247  解决: 67
[[提交](https://acm.sustech.edu.cn/onlinejudge/submitpage.php?cid=1055&pid=5&langmask=0)][[状态](https://acm.sustech.edu.cn/onlinejudge/problemstatus.php?id=1266)][[讨论版](https://acm.sustech.edu.cn/onlinejudge/bbs.php?pid=1266&cid=1055)]

## 题目描述

Yuki is a clever girl and she is good at mathematics. One day, she gets an array aa of nn integers: a1,a2,…,ana1,a2,…,an. She wants to know the from-now-on minimum difference of a1,a2,…,an−1a1,a2,…,an−1, and your task is to help her to calculate them.The **from-now-on minimum difference** of aiai, denoted by hihi, is defined as: hi=minj>i|aj−ai|hi=minj>i|aj−ai|.

## 输入

The first line contains one integer: nn (2≤n≤2×1062≤n≤2×106). The second line contains nn space-separated integers: a1,a2,…,ana1,a2,…,an — elements of the array aa (1≤ai≤1091≤ai≤109 ).

## 输出

Print one line with n−1n−1 space-separated intergers: h1,h2,…,hn−1h1,h2,…,hn−1.

## 样例输入

```
5
1 2 3 4 5
```

## 样例输出

```
1 1 1 1
```

## 提示




You may solve this problem using some ~~advanced data structures~~. However, it can be solved in a simple and efficient way merely by **sorting algorithm** and **linked list**. 




Please note that the size of input might be really large, so you might want to use an efficient way to read the input data. 



问题 G: Gnisrever时间限制: 2 Sec  内存限制: 128 MB
提交: 60  解决: 9
[[提交](https://acm.sustech.edu.cn/onlinejudge/submitpage.php?cid=1055&pid=6&langmask=0)][[状态](https://acm.sustech.edu.cn/onlinejudge/problemstatus.php?id=1267)][[讨论版](https://acm.sustech.edu.cn/onlinejudge/bbs.php?pid=1267&cid=1055)]

## 题目描述

Narnal loves reversing and Fibonacci sequence. When he gets an array with length NN, he would reverse the array in the intervals determined by Fibonacci sequence for KK times.

Let FnFn is the nn-th Fibonacci number: F1=F2=1,Fn=Fn−1+Fn−2F1=F2=1,Fn=Fn−1+Fn−2 for all n≥3n≥3.

Let sn=F2n−1modNsn=F2n−1modN and let tn=F2nmodNtn=F2nmodN.

Narnal's reversing always starts with an array of integers A=(A[0],…,A[N−1])A=(A[0],…,A[N−1]) where initially every A[i]A[i] is equal to ii. Now perform KK successive operations on AA, where the jj-th operation consists of reversing the order of those elements in AA with indices between sjsj and tjtj (both ends inclusive).

Finally, Narnal's happiness is defined as R(N,K)=∑N−1i=0i×A[i]R(N,K)=∑i=0N−1i×A[i] after KK operations.

1≤N≤1015,1≤K≤5×1031≤N≤1015,1≤K≤5×103.

## 输入

One line gives NN and KK, separated by space.

## 输出

One line with only R(N,K)mod106R(N,K)mod106.

## 样例输入

```
5 4
```

## 样例输出

```
27
```

## 提示



Consider using nodes to represent the sequences of consecutive numbers.



Using linked list reversing!



R(5,4)=27R(5,4)=27 can be seen from the following procedure:
Initial position: (0,1,2,3,4)(0,1,2,3,4)
Step 1 - Reverse A[1]A[1] to A[1]A[1]: (0,1,2,3,4)(0,1,2,3,4)
Step 2 - Reverse A[2]A[2] to A[3]A[3]: (0,1,3,2,4)(0,1,3,2,4)
Step 3 - Reverse A[0]A[0] to A[3]A[3]: (2,3,1,0,4)(2,3,1,0,4)
Step 4 - Reverse A[3]A[3] to A[1]A[1]: (2,0,1,3,4)(2,0,1,3,4)
R(5,4)=0×2+1×0+2×1+3×3+4×4=27R(5,4)=0×2+1×0+2×1+3×3+4×4=27.



Also, R(102,102)=246597R(102,102)=246597.